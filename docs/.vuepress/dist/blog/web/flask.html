<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Flask | WeiGao</title>
    <meta name="description" content="Welcome, friend! ">
    <link rel="icon" href="/logo3.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.b3a4b39c.css" as="style"><link rel="preload" href="/assets/js/app.a77dfa45.js" as="script"><link rel="preload" href="/assets/js/3.d6c3402d.js" as="script"><link rel="preload" href="/assets/js/49.c444e62e.js" as="script"><link rel="preload" href="/assets/js/17.d6d943e2.js" as="script"><link rel="prefetch" href="/assets/js/1.02527821.js"><link rel="prefetch" href="/assets/js/10.25816a96.js"><link rel="prefetch" href="/assets/js/11.4b7fc5e8.js"><link rel="prefetch" href="/assets/js/12.927d304e.js"><link rel="prefetch" href="/assets/js/13.15b1ee57.js"><link rel="prefetch" href="/assets/js/14.d7820ebc.js"><link rel="prefetch" href="/assets/js/15.0f580157.js"><link rel="prefetch" href="/assets/js/16.eddce9c1.js"><link rel="prefetch" href="/assets/js/18.4cbabfe8.js"><link rel="prefetch" href="/assets/js/19.203a4b54.js"><link rel="prefetch" href="/assets/js/20.84f64606.js"><link rel="prefetch" href="/assets/js/21.d946f205.js"><link rel="prefetch" href="/assets/js/22.29decdeb.js"><link rel="prefetch" href="/assets/js/23.0c68e0cf.js"><link rel="prefetch" href="/assets/js/24.5a910ee8.js"><link rel="prefetch" href="/assets/js/25.6d9e71c8.js"><link rel="prefetch" href="/assets/js/26.4366358f.js"><link rel="prefetch" href="/assets/js/27.c82c2eb2.js"><link rel="prefetch" href="/assets/js/28.f77d46a8.js"><link rel="prefetch" href="/assets/js/29.4156ae66.js"><link rel="prefetch" href="/assets/js/30.bebcd280.js"><link rel="prefetch" href="/assets/js/31.71fd3d52.js"><link rel="prefetch" href="/assets/js/32.e5aaaea2.js"><link rel="prefetch" href="/assets/js/33.5ecd979f.js"><link rel="prefetch" href="/assets/js/34.a1b066d8.js"><link rel="prefetch" href="/assets/js/35.c69bb055.js"><link rel="prefetch" href="/assets/js/36.cd4fb177.js"><link rel="prefetch" href="/assets/js/37.4d579b7a.js"><link rel="prefetch" href="/assets/js/38.9a6df1de.js"><link rel="prefetch" href="/assets/js/39.68e55e0f.js"><link rel="prefetch" href="/assets/js/4.6a24f696.js"><link rel="prefetch" href="/assets/js/40.421d26ad.js"><link rel="prefetch" href="/assets/js/41.7644abc0.js"><link rel="prefetch" href="/assets/js/42.549b4239.js"><link rel="prefetch" href="/assets/js/43.d84d3390.js"><link rel="prefetch" href="/assets/js/44.c3704873.js"><link rel="prefetch" href="/assets/js/45.9ea63982.js"><link rel="prefetch" href="/assets/js/46.dc514f33.js"><link rel="prefetch" href="/assets/js/47.e4ca73c3.js"><link rel="prefetch" href="/assets/js/48.826bc94e.js"><link rel="prefetch" href="/assets/js/5.e9cb2b9c.js"><link rel="prefetch" href="/assets/js/50.63614e72.js"><link rel="prefetch" href="/assets/js/51.fad6ac64.js"><link rel="prefetch" href="/assets/js/52.cd95a61d.js"><link rel="prefetch" href="/assets/js/53.42aa62dd.js"><link rel="prefetch" href="/assets/js/54.0940b610.js"><link rel="prefetch" href="/assets/js/55.75e5b67f.js"><link rel="prefetch" href="/assets/js/56.e0b59e11.js"><link rel="prefetch" href="/assets/js/57.a525b28e.js"><link rel="prefetch" href="/assets/js/58.4b5eb4b2.js"><link rel="prefetch" href="/assets/js/59.3f43a59d.js"><link rel="prefetch" href="/assets/js/6.e203c557.js"><link rel="prefetch" href="/assets/js/60.88977b9f.js"><link rel="prefetch" href="/assets/js/61.282d3191.js"><link rel="prefetch" href="/assets/js/62.52a7a744.js"><link rel="prefetch" href="/assets/js/63.b7ec231c.js"><link rel="prefetch" href="/assets/js/7.564fbfe1.js"><link rel="prefetch" href="/assets/js/8.4866d057.js"><link rel="prefetch" href="/assets/js/9.ae718e4b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b3a4b39c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">WeiGao</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/books/" class="nav-link">Books</a></div><div class="nav-item"><a href="/discuss/" class="nav-link">Discuss</a></div><div class="nav-item"><a href="/logs/" class="nav-link">Docs</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Code</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/cpp/" class="nav-link">C/C++</a></li><li class="dropdown-item"><!----> <a href="/algorithm/python/" class="nav-link">Python</a></li><li class="dropdown-item"><!----> <a href="/algorithm/leetcode/" class="nav-link">Leetcode</a></li><li class="dropdown-item"><!----> <a href="/algorithm/web/" class="nav-link">Web&amp;JS</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/books/" class="nav-link">Books</a></div><div class="nav-item"><a href="/discuss/" class="nav-link">Discuss</a></div><div class="nav-item"><a href="/logs/" class="nav-link">Docs</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Code</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/cpp/" class="nav-link">C/C++</a></li><li class="dropdown-item"><!----> <a href="/algorithm/python/" class="nav-link">Python</a></li><li class="dropdown-item"><!----> <a href="/algorithm/leetcode/" class="nav-link">Leetcode</a></li><li class="dropdown-item"><!----> <a href="/algorithm/web/" class="nav-link">Web&amp;JS</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Zen</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/zen/" class="sidebar-link">The Zen of Python</a></li><li><a href="/blog/zen/thoughts.html" class="sidebar-link">Thoughts</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Web</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/blog/web/" class="sidebar-link">Quick Note</a></li><li><a href="/blog/web/vue-cli.html" class="sidebar-link">Vue CLI</a></li><li><a href="/blog/web/vue.html" class="sidebar-link">Vue</a></li><li><a href="/blog/web/database.html" class="sidebar-link">MongoDB</a></li><li><a href="/blog/web/flask.html" class="active sidebar-link">Flask</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/web/flask.html#reference" class="sidebar-link">Reference</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#socketio" class="sidebar-link">SocketIO</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#flask-structure" class="sidebar-link">Flask Structure</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#blueprint" class="sidebar-link">Blueprint</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#virtual-environment" class="sidebar-link">Virtual environment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/web/flask.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#usage" class="sidebar-link">Usage</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#requirement-txt" class="sidebar-link">Requirement.txt</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#video-streaming-with-flask" class="sidebar-link">Video Streaming with Flask</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#flask-script" class="sidebar-link">Flask Script</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#web-server" class="sidebar-link">Web Server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/web/flask.html#wsgi" class="sidebar-link">WSGI</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#nginx" class="sidebar-link">Nginx</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#django" class="sidebar-link">Django</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/web/flask.html#installation-2" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#establish-application" class="sidebar-link">Establish application</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/web/flask.html#new-words" class="sidebar-link">New Words</a></li></ul></li><li><a href="/blog/web/javascript.html" class="sidebar-link">JavaScript</a></li><li><a href="/blog/web/css.html" class="sidebar-link">CSS</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Project</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Tool</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Research</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content default"><h1 id="flask"><a href="#flask" aria-hidden="true" class="header-anchor">#</a> Flask</h1> <p><a href="#socketio">How to build socketio in Flask project : socketio</a></p> <p>Flask <strong>variable, <a href="#blueprint">blueprint</a></strong> and install from <strong><a href="#requirement.txt">requirement.txt</a></strong>, some basic knowledge about <strong>WSGI, Nginx and Django</strong>.</p> <h2 id="reference"><a href="#reference" aria-hidden="true" class="header-anchor">#</a> Reference</h2> <table><thead><tr><th>NAME</th> <th>URL</th> <th>DESCRIPTION</th></tr></thead> <tbody><tr><td>flask_socketio</td> <td><a href="https://github.com/miguelgrinberg/flack" target="_blank" rel="noopener noreferrer">https://github.com/miguelgrinberg/flack<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td>a project using <code>flask_socketio</code></td></tr> <tr><td></td> <td>https://flask-socketio.readthedocs.io/en/latest/</td> <td><code>flask_socketio</code> official tutorial</td></tr> <tr><td>blueprint</td> <td>http://flask.pocoo.org/docs/1.0/blueprints/</td> <td><a href="http://flask.pocoo.org/docs/1.0/blueprints/" target="_blank" rel="noopener noreferrer">official tutorial<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td></tr></tbody></table> <h2 id="socketio"><a href="#socketio" aria-hidden="true" class="header-anchor">#</a> SocketIO</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>pip <span class="token function">install</span> flask-socketio
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="flask-structure"><a href="#flask-structure" aria-hidden="true" class="header-anchor">#</a> Flask Structure</h2> <p><strong>application context and request context</strong>：</p> <table><thead><tr><th>variable</th> <th>context</th> <th>description</th></tr></thead> <tbody><tr><td><code>current_app</code></td> <td>application context</td> <td>The application instance for the active application.</td></tr> <tr><td><code>g</code></td> <td>ac</td> <td></td></tr> <tr><td><code>request</code></td> <td>request context</td> <td></td></tr> <tr><td><code>session</code></td> <td>rc</td> <td></td></tr></tbody></table> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> flask <span class="token keyword">import</span> current_app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><a href="http://flask.pocoo.org/docs/1.0/api/#flask.g" target="_blank" rel="noopener noreferrer"><code>g</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is a special object that is unique for each request. It is used to store data that might be accessed by multiple functions during the request. The connection is stored and reused instead of creating a new connection if <code>get_db</code> is called a second time in the same request.</p> <h2 id="blueprint"><a href="#blueprint" aria-hidden="true" class="header-anchor">#</a> Blueprint</h2> <p><a href="http://flask.pocoo.org/docs/1.0/blueprints/" target="_blank" rel="noopener noreferrer">Tutorial : Modular Applications with Blueprints<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>We use the <code>create_app()</code> so that the application is created at runtime.</p> <p>A blueprint is similar to an application in that it can also define routes. The difference is that routes associated with a blueprint are in a dormant state until the blueprint is registered with an application, at which point the routes become part of it.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># app/main/__init__.py</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Blueprint
main <span class="token operator">=</span> Blueprint<span class="token punctuation">(</span><span class="token string">'main'</span><span class="token punctuation">,</span> __name__<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>The constructor for this class takes two required arguments: <strong>the blueprint name</strong> and <strong>the model or package where the blueprint is located</strong>(always default <code>__name__</code>).</p> <h2 id="virtual-environment"><a href="#virtual-environment" aria-hidden="true" class="header-anchor">#</a> Virtual environment</h2> <h3 id="installation"><a href="#installation" aria-hidden="true" class="header-anchor">#</a> Installation</h3> <p>Take Linux system as example:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pip install virtualenv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="usage"><a href="#usage" aria-hidden="true" class="header-anchor">#</a> Usage</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>cd <span class="token punctuation">[</span>project directory<span class="token punctuation">]</span>
virtualenv venv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>该命令执行后，将在当前目录中建立一个venv目录，该目录复制了一份完整的当前系统的python环境。之后运行python时可以直接运行该项目的bin文件夹中的命令。</p> <p>例：在当前虚环境下安装Tornado组件：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">.</span><span class="token operator">/</span>venv<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>pip install tornado
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>或者在该虚环境中运行python程序：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">.</span><span class="token operator">/</span>venv<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>python xxxx<span class="token punctuation">.</span>py
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>也可以使用<code>activate</code>命令启动虚环境，之后不必再显示地调用虚环境bin文件夹中的命令：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>source <span class="token punctuation">.</span><span class="token operator">/</span>venv<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>activate
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>退出虚拟环境使用<code>deactive</code>：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> xxx<span class="token punctuation">:</span><span class="token operator">~</span><span class="token operator">/</span>xxx$ deactivate
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="requirement-txt"><a href="#requirement-txt" aria-hidden="true" class="header-anchor">#</a> Requirement.txt</h2> <p>Install from <code>requirement.txt</code>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pip install <span class="token operator">-</span>r requirements<span class="token punctuation">.</span>txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>generate a <code>requirement.txt</code> from current project:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>pip freeze <span class="token operator">&gt;</span> requirement.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="video-streaming-with-flask"><a href="#video-streaming-with-flask" aria-hidden="true" class="header-anchor">#</a> Video Streaming with Flask</h2> <h2 id="flask-script"><a href="#flask-script" aria-hidden="true" class="header-anchor">#</a> Flask Script</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># manage.py</span>
<span class="token keyword">import</span> os
<span class="token keyword">from</span> app <span class="token keyword">import</span> create_app<span class="token punctuation">,</span> db
<span class="token keyword">from</span> app<span class="token punctuation">.</span>models <span class="token keyword">import</span> User<span class="token punctuation">,</span> Role
<span class="token keyword">from</span> flask<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>script <span class="token keyword">import</span> Manager<span class="token punctuation">,</span> Shell
<span class="token keyword">from</span> flask<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>migrate <span class="token keyword">import</span> Migrate<span class="token punctuation">,</span> MigrateCommand

app <span class="token operator">=</span> create_app<span class="token punctuation">(</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">'FLASK_CONFIG'</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token string">'default'</span><span class="token punctuation">)</span>
manager <span class="token operator">=</span> Manager<span class="token punctuation">(</span>app<span class="token punctuation">)</span>
migrate <span class="token operator">=</span> Migrate<span class="token punctuation">(</span>app<span class="token punctuation">,</span> db<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">make_shell_context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>app<span class="token operator">=</span>app<span class="token punctuation">,</span> db<span class="token operator">=</span>db<span class="token punctuation">,</span> User<span class="token operator">=</span>User<span class="token punctuation">,</span> Role<span class="token operator">=</span>Role<span class="token punctuation">)</span>

manager<span class="token punctuation">.</span>add_command<span class="token punctuation">(</span><span class="token string">&quot;shell&quot;</span><span class="token punctuation">,</span> Shell<span class="token punctuation">(</span>make_context<span class="token operator">=</span>make_shell_context<span class="token punctuation">)</span><span class="token punctuation">)</span>
manager<span class="token punctuation">.</span>add_command<span class="token punctuation">(</span><span class="token string">'db'</span><span class="token punctuation">,</span> MigrateCommand<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    manager<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="web-server"><a href="#web-server" aria-hidden="true" class="header-anchor">#</a> Web Server</h2> <p>目前主流的Web服务器包括<strong>Nginx, Apache, lighthttpd, IIS, etc..</strong>，Python服务端程序在Linux平台下使用最广泛的是Nginx。</p> <h3 id="wsgi"><a href="#wsgi" aria-hidden="true" class="header-anchor">#</a> WSGI</h3> <p>Web Server Gateway Interface[^2], 为Python语言定义Web服务器和服务端程序的通用接口规范。</p> <p>[^2]: <a href="https://en.wikipedia.org/wiki/Web_Server_Gateway_Interface" target="_blank" rel="noopener noreferrer">WSGI, wiki<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="nginx"><a href="#nginx" aria-hidden="true" class="header-anchor">#</a> Nginx</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> nginx
<span class="token function">sudo</span> <span class="token function">service</span> nginx start/status/stop/restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="django"><a href="#django" aria-hidden="true" class="header-anchor">#</a> Django</h2> <h3 id="installation-2"><a href="#installation-2" aria-hidden="true" class="header-anchor">#</a> Installation</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pip3 install django
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>测试是否安装成功：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>python3
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> django
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>django<span class="token punctuation">.</span>VERSION<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="establish-application"><a href="#establish-application" aria-hidden="true" class="header-anchor">#</a> Establish application</h3> <p>建立项目：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>django<span class="token operator">-</span>admin startproject <span class="token punctuation">[</span>project<span class="token operator">-</span>name<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>建立应用：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>python manage<span class="token punctuation">.</span>py startapp <span class="token punctuation">[</span>app<span class="token operator">-</span>name<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>例如，在当前目录中创建一个项目<em>my_project</em>, 并且拥有特定的目录结构：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>djangp<span class="token operator">-</span>admin startproject my_project
cd my_project
python3 manage<span class="token punctuation">.</span>py startapp my_app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>完成之后目录结构类似于：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>my_project/
	manage.py
	my_project/
		__init__.py
		settings.py
		urls.py
		wsgi.py
	my_app/
		__init__.py
		admin.py
		apps.py
		migrations/
			__init__.py
		models.py
		tests.py
		views.py
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>内置web服务器运行：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>python manage<span class="token punctuation">.</span>py runserver <span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">:</span><span class="token number">8001</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>生成数据移植文件：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>python manage<span class="token punctuation">.</span>py makemigrations app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>移植到数据库：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>python manage<span class="token punctuation">.</span>py migrate
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="new-words"><a href="#new-words" aria-hidden="true" class="header-anchor">#</a> New Words</h2> <table><thead><tr><th style="text-align:center;">words</th> <th style="text-align:center;">means</th></tr></thead> <tbody><tr><td style="text-align:center;">PK</td> <td style="text-align:center;">primary key</td></tr> <tr><td style="text-align:center;">FK</td> <td style="text-align:center;">foregin key</td></tr> <tr><td style="text-align:center;">CRUD</td> <td style="text-align:center;">create, retrieve, update and delete</td></tr></tbody></table></div> <!----> <!----> </div></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/3.d6c3402d.js" defer></script><script src="/assets/js/49.c444e62e.js" defer></script><script src="/assets/js/17.d6d943e2.js" defer></script><script src="/assets/js/app.a77dfa45.js" defer></script>
  </body>
</html>
