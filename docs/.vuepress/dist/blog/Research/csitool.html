<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CSI Tool | weigao</title>
    <meta name="description" content="...">
    <link rel="icon" href="/android-chrome-512x512.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.9553969a.css" as="style"><link rel="preload" href="/assets/js/app.8c2dddc1.js" as="script"><link rel="preload" href="/assets/js/5.cd1db3e5.js" as="script"><link rel="preload" href="/assets/js/84.0ad20007.js" as="script"><link rel="preload" href="/assets/js/24.fa6e8fb7.js" as="script"><link rel="preload" href="/assets/js/23.2c687b63.js" as="script"><link rel="prefetch" href="/assets/js/1.61fa752c.js"><link rel="prefetch" href="/assets/js/10.2ea75c27.js"><link rel="prefetch" href="/assets/js/100.12e18a8d.js"><link rel="prefetch" href="/assets/js/101.ba47a8ea.js"><link rel="prefetch" href="/assets/js/11.bb91b584.js"><link rel="prefetch" href="/assets/js/12.59472db4.js"><link rel="prefetch" href="/assets/js/13.82dc035e.js"><link rel="prefetch" href="/assets/js/14.3f854a99.js"><link rel="prefetch" href="/assets/js/15.2df0cfd8.js"><link rel="prefetch" href="/assets/js/16.7269e8f3.js"><link rel="prefetch" href="/assets/js/17.b3d4362d.js"><link rel="prefetch" href="/assets/js/18.337eab3d.js"><link rel="prefetch" href="/assets/js/19.dbb75492.js"><link rel="prefetch" href="/assets/js/2.abd16662.js"><link rel="prefetch" href="/assets/js/20.3c6e1006.js"><link rel="prefetch" href="/assets/js/21.48fc9301.js"><link rel="prefetch" href="/assets/js/22.82d214b6.js"><link rel="prefetch" href="/assets/js/25.738cedaa.js"><link rel="prefetch" href="/assets/js/26.c5def0f6.js"><link rel="prefetch" href="/assets/js/27.2e60968b.js"><link rel="prefetch" href="/assets/js/28.a5d0a7c3.js"><link rel="prefetch" href="/assets/js/29.abf7f7b1.js"><link rel="prefetch" href="/assets/js/30.f056bef0.js"><link rel="prefetch" href="/assets/js/31.b78ba091.js"><link rel="prefetch" href="/assets/js/32.18d30b51.js"><link rel="prefetch" href="/assets/js/33.d700f59d.js"><link rel="prefetch" href="/assets/js/34.c05ed437.js"><link rel="prefetch" href="/assets/js/35.afb321bd.js"><link rel="prefetch" href="/assets/js/36.68bbb287.js"><link rel="prefetch" href="/assets/js/37.e89bdebe.js"><link rel="prefetch" href="/assets/js/38.1f73a8c6.js"><link rel="prefetch" href="/assets/js/39.9ed66f9d.js"><link rel="prefetch" href="/assets/js/4.20b55e5f.js"><link rel="prefetch" href="/assets/js/40.9077eb22.js"><link rel="prefetch" href="/assets/js/41.98693926.js"><link rel="prefetch" href="/assets/js/42.79243cc1.js"><link rel="prefetch" href="/assets/js/43.a7bbba1f.js"><link rel="prefetch" href="/assets/js/44.1f8b8410.js"><link rel="prefetch" href="/assets/js/45.51c6b033.js"><link rel="prefetch" href="/assets/js/46.6cb9eac9.js"><link rel="prefetch" href="/assets/js/47.1105348d.js"><link rel="prefetch" href="/assets/js/48.f85d7876.js"><link rel="prefetch" href="/assets/js/49.009aab65.js"><link rel="prefetch" href="/assets/js/50.0f427177.js"><link rel="prefetch" href="/assets/js/51.13b2a5c0.js"><link rel="prefetch" href="/assets/js/52.cbc4eeea.js"><link rel="prefetch" href="/assets/js/53.2374bd93.js"><link rel="prefetch" href="/assets/js/54.34cf31bb.js"><link rel="prefetch" href="/assets/js/55.1d7e3563.js"><link rel="prefetch" href="/assets/js/56.647d3fbf.js"><link rel="prefetch" href="/assets/js/57.81a8354f.js"><link rel="prefetch" href="/assets/js/58.ac99e744.js"><link rel="prefetch" href="/assets/js/59.e3bb8a78.js"><link rel="prefetch" href="/assets/js/6.46455cb0.js"><link rel="prefetch" href="/assets/js/60.76f1be0c.js"><link rel="prefetch" href="/assets/js/61.547bf157.js"><link rel="prefetch" href="/assets/js/62.bb2d5f35.js"><link rel="prefetch" href="/assets/js/63.e4c325f4.js"><link rel="prefetch" href="/assets/js/64.39937791.js"><link rel="prefetch" href="/assets/js/65.79722d0a.js"><link rel="prefetch" href="/assets/js/66.16a77a10.js"><link rel="prefetch" href="/assets/js/67.d9fb39f5.js"><link rel="prefetch" href="/assets/js/68.c266e649.js"><link rel="prefetch" href="/assets/js/69.6a56611b.js"><link rel="prefetch" href="/assets/js/7.d6c547e2.js"><link rel="prefetch" href="/assets/js/70.b9c6794f.js"><link rel="prefetch" href="/assets/js/71.319f7350.js"><link rel="prefetch" href="/assets/js/72.e07abb24.js"><link rel="prefetch" href="/assets/js/73.0406a3c6.js"><link rel="prefetch" href="/assets/js/74.9b41ca8d.js"><link rel="prefetch" href="/assets/js/75.ce841083.js"><link rel="prefetch" href="/assets/js/76.b8a63a09.js"><link rel="prefetch" href="/assets/js/77.44094ede.js"><link rel="prefetch" href="/assets/js/78.5d2d7624.js"><link rel="prefetch" href="/assets/js/79.89aa3f8f.js"><link rel="prefetch" href="/assets/js/8.2135ddb7.js"><link rel="prefetch" href="/assets/js/80.9b79b455.js"><link rel="prefetch" href="/assets/js/81.b9c4e6cc.js"><link rel="prefetch" href="/assets/js/82.c089b765.js"><link rel="prefetch" href="/assets/js/83.368be746.js"><link rel="prefetch" href="/assets/js/85.bed6c2b0.js"><link rel="prefetch" href="/assets/js/86.a567014d.js"><link rel="prefetch" href="/assets/js/87.e4edfddc.js"><link rel="prefetch" href="/assets/js/88.73d31df8.js"><link rel="prefetch" href="/assets/js/89.6d4e53cb.js"><link rel="prefetch" href="/assets/js/9.d01dceaa.js"><link rel="prefetch" href="/assets/js/90.0129f07f.js"><link rel="prefetch" href="/assets/js/91.d16664ce.js"><link rel="prefetch" href="/assets/js/92.06e8dcff.js"><link rel="prefetch" href="/assets/js/93.b5b18dd9.js"><link rel="prefetch" href="/assets/js/94.84d5e718.js"><link rel="prefetch" href="/assets/js/95.eb85deaa.js"><link rel="prefetch" href="/assets/js/96.a9514789.js"><link rel="prefetch" href="/assets/js/97.8b1d193f.js"><link rel="prefetch" href="/assets/js/98.82feff02.js"><link rel="prefetch" href="/assets/js/99.7f6f4c17.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9553969a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">weigao</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">Algorithm</a></div><div class="nav-item"><a href="/commits/" class="nav-link">Commits</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">Algorithm</a></div><div class="nav-item"><a href="/commits/" class="nav-link">Commits</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>CSI Tool</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/Research/csitool.html#_1-1-预备工作" class="sidebar-link">1.1 预备工作</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/Research/csitool.html#_1-2-配置csi-tool" class="sidebar-link">1.2 配置CSI-Tool</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="csi-tool"><a href="#csi-tool" aria-hidden="true" class="header-anchor">#</a> <span class="badge tip" style="vertical-align:top;" data-v-c13ee5b0>Research</span> CSI Tool</h1> <p>These instructions are currently expected to work on Linux operating systems that are based on an upstream Linux kernel version between 3.2 (e.g. Ubuntu 12.04) and 4.2 (e.g. Ubuntu 14.04.4).
The IWL5300 provides 802.11n channel state information in a format that reports the channel matrices for 30 subcarrier groups, which is about one group for every 2 subcarriers at 20 MHz or one in 4 at 40 MHz. Each channel matrix entry is a complex number, with signed 8-bit resolution each for the real and imaginary parts. It specifies the gain and phase of the signal path between a single transmit-receive antenna pair.</p> <h2 id="_1-1-预备工作"><a href="#_1-1-预备工作" aria-hidden="true" class="header-anchor">#</a> 1.1 预备工作</h2> <p><strong>硬件环境:</strong></p> <ol><li>intel 5300网卡（笔记本为mini-pcie接口，半高网卡、台式机为pcie接口，全高网卡）</li> <li>无线路由器，一般为市面上常见的商用路由器即可，不设置wifi密码</li></ol> <p><strong>软件环境</strong></p> <p>软件环境的配置较为困难，一有不慎可能会前功尽弃，不要气馁，多尝试几次也是自身提升的过程！
软件要求：</p> <ul><li>Ubuntu &gt;= 12.04LTS 操作系统镜像</li> <li>csi-tool.tar文件
(PS：这两个文件我已经上传到百度云，<a href="http://pan.baidu.com/s/1dEZ9zSt" title="csi-tool.tar" target="_blank" rel="noopener noreferrer">csi-tool.tar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>和<a href="http://pan.baidu.com/s/1qY6wZN2" title="Ubuntu-12.04-Desktop" target="_blank" rel="noopener noreferrer">Ubuntu-12.04-Desktop<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</li></ul> <h2 id="_1-2-配置csi-tool"><a href="#_1-2-配置csi-tool" aria-hidden="true" class="header-anchor">#</a> 1.2 配置CSI-Tool</h2> <p><strong>注意：系统安装完成后，查看一下内核信息，是否为：<code>Linux Version 3.2.0.84-generic-pae</code>，然后进行下一步</strong></p> <p>可以参考官方文档：<a href="http://dhalperi.github.io/linux-80211n-csitool/installation.html" title="Linux 802.11n CSI Tool" target="_blank" rel="noopener noreferrer">Linux 802.11n CSI Tool<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>为了提高下载速度，首先需要<strong>更换软件源</strong>。进入Ubuntu桌面系统，CTRL++ALT+T打开命令行，在命令行输入：</p> <p><code>sudo vi /etc/apt/source.list</code></p> <p>将里面所有的内容替换成搜狐的软件源，具体可以参考<a href="https://www.weigao.cc/blog/2017/01/02/aptsource.html" target="_blank" rel="noopener noreferrer">apt-source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上面说的。
接下来：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> gcc <span class="token function">make</span> linux-headers-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -r<span class="token variable">)</span></span> git-core
<span class="token comment">#这一步是安装csitool所需要的一些依赖</span>

<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> iw
<span class="token keyword">echo</span> iface wlan0 inet manual <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> -a /etc/network/interfaces
<span class="token function">sudo</span> restart network-manager
<span class="token comment">#依次执行这三步</span>

<span class="token keyword">echo</span> blacklist iwldvm <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> -a /etc/modprobe.d/csitool.conf
<span class="token keyword">echo</span> blacklist iwlwifi <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> -a /etc/modprobe.d/csitool.conf
<span class="token comment">#这两步是为了电脑在开机的时候不启动无线，不然有可能导致电脑无法正常开机</span>
</code></pre></div><p>接下来找到我们之前下载好的csi-tool.tar文件，解压：</p> <p><code>tar -xvf csi-tool.tar</code></p> <p>得到zip文件，校验一下：</p> <p><code>MD5 (csi-tool.zip) = 9390f2d1a38d7e0cbd2d8115ea6dc05b</code></p> <p>然后继续解压得到的zip文件：</p> <p><code>unzip csi-tool.zip</code></p> <p>解压以后：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#首先用cd命令进入到linux-80211n-csitool文件目录下</span>
<span class="token function">cd</span> linux-80211n-csitool

<span class="token comment">#对于特殊版本的内核：</span>
<span class="token comment">#CSITOOL_KERNEL_TAG=csitool-$(uname -r | cut -d . -f 1-2)</span>

<span class="token comment">#接下来编译</span>
<span class="token function">make</span> -C /lib/modules/<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -r<span class="token variable">)</span></span>/build M<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">pwd</span><span class="token variable">)</span></span>/drivers/net/wireless/iwlwifi modules
<span class="token function">sudo</span> <span class="token function">make</span> -C /lib/modules/<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -r<span class="token variable">)</span></span>/build M<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">pwd</span><span class="token variable">)</span></span>/drivers/net/wireless/iwlwifi INSTALL_MOD_DIR<span class="token operator">=</span>updates \
    modules_install
<span class="token function">sudo</span> depmod
<span class="token function">cd</span> <span class="token punctuation">..</span>
</code></pre></div><p>完成之后，会看到提示 <em>Can't read private key</em> 的提示，可以进行下一步：
在 supplyment 文件夹外面执行：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token keyword">for</span> <span class="token function">file</span> <span class="token keyword">in</span> /lib/firmware/iwlwifi-5000-*.ucode<span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token function">sudo</span> <span class="token function">mv</span> <span class="token variable">$file</span> <span class="token variable">$file</span>.orig<span class="token punctuation">;</span> <span class="token keyword">done</span>
<span class="token function">sudo</span> <span class="token function">cp</span> linux-80211n-csitool-supplementary/firmware/iwlwifi-5000-2.ucode.sigcomm2010 /lib/firmware/
<span class="token function">sudo</span> <span class="token function">ln</span> -s iwlwifi-5000-2.ucode.sigcomm2010 /lib/firmware/iwlwifi-5000-2.ucode
<span class="token function">make</span> -C linux-80211n-csitool-supplementary/netlink
</code></pre></div><p>执行完以后基本上就完成了，接下来是测试步骤：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> modprobe -r iwlwifi mac80211
<span class="token comment">#如果提示 &quot;FATAL: Module iwlwifi is in use.&quot; ，执行下一步</span>
<span class="token function">sudo</span> modprobe -r iwldvm iwlwifi mac80211

<span class="token comment">#接下来reload</span>
<span class="token function">sudo</span> modprobe iwlwifi connector_log<span class="token operator">=</span>0x1
<span class="token function">sudo</span> linux-80211n-csitool-supplementary/netlink/log_to_file csi.dat
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">4/28/2019, 5:57:40 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.8c2dddc1.js" defer></script><script src="/assets/js/5.cd1db3e5.js" defer></script><script src="/assets/js/84.0ad20007.js" defer></script><script src="/assets/js/24.fa6e8fb7.js" defer></script><script src="/assets/js/23.2c687b63.js" defer></script>
  </body>
</html>
